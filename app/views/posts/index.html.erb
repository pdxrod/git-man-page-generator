<style type="text/css">
.popup
{
        position:absolute;
        border:solid 1px black;
        background-color:white;
        padding:4px;
}
</style>

<script type="text/javascript">
function findPos(obj) {
        var curleft = curtop = 0;
        if (obj.offsetParent) {
                curleft = obj.offsetLeft
                curtop = obj.offsetTop
                while (obj = obj.offsetParent) {
                        curleft += obj.offsetLeft
                        curtop += obj.offsetTop
                }
        }
        return [curleft,curtop];
}

function display_menu(parent, named, pic, length)
{
        if( pic == '' ) { return; }
        pos = parseInt(length) + 10;
        var menu_element = document.getElementById(named);
        menu_element.style.display = "";
        menu_element.innerHTML = '<img src="/data/' + pic +
                  '" width="67" height="' + length + '" />';
        var placement = findPos(parent);
        menu_element.style.left = (67 + placement[0]) + "px";
        menu_element.style.top =  (placement[1] - pos) + "px";
}

function hide_menu(named)
{
        var menu_element = document.getElementById(named);
        menu_element.style.display = "none";
}
</script>

    <div class="popup" id="picpopup" style="display:none;">

    </div>

<div id="pdxspurs-list">

<table>
  <tr>
    <th align='left'>thread</th>
    <th align='left'>who</th>
    <th align='left'>when</th>
    <th align='left'>title</th>
    <th align='left'>message</th>
    <th>&nbsp;</th>
  </tr>
<tr>
  <td colspan='6'><hr /></td>
</tr>

<% for post in @posts %>
  <tr valign="top" class="<%= cycle('list-line-odd', 'list-line-even') %>">

    <td><%=h post.list.title_display %></td>
    <td><%=h post.user.name_display %></td>
    <td><%=h post.date_display %></td>
    
    <td>
      <a href="<%= post.edit_or_view( current_user ) %>" 
        onmouseover="display_menu( this, 'picpopup', '<%= post.image %>', <%= post.length %> );" 
        onmouseout="hide_menu( 'picpopup' );"><%=h post.title %></a>
    </td>
    <td><%=h post.short %></td>
   
    <% if can_delete?( post ) %>
      <td>      
          <%=
           button_to "delete", { :action => "destroy", :id => post.id },
            :confirm => "are you sure you want to delete this message?", :method => :delete
          %>
      </td>    
    <% else %>
      <td><br /></td>  
    <% end %>

  </tr>
<% end %>
</table>

</div>
<br/>

<%= link_to MESSAGE_ADD, {:controller => 'lists', :action => 'index'}%>


